import{saveAs as e}from"file-saver";import t from"xlsx";function r(){if(!(this instanceof r))return new r;this.SheetNames=[],this.Sheets={}}function n(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function a({multiHeader:a=[],header:o,data:l,filename:s,merges:h=[],autoWidth:c=!0,bookType:i="xlsx"}={}){s=s||"excel-list",(l=[...l]).unshift(o);for(let e=a.length-1;e>-1;e--)l.unshift(a[e]);var f="SheetJS",u=new r,g=function(e,r){for(var n,a={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},l=0;l!=e.length;++l)for(var s=0;s!=e[l].length;++s){o.s.r>l&&(o.s.r=l),o.s.c>s&&(o.s.c=s),o.e.r<l&&(o.e.r=l),o.e.c<s&&(o.e.c=s);var h={v:e[l][s]};if(null!=h.v){var c=t.utils.encode_cell({c:s,r:l});"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.t="n",h.z=t.SSF._table[14],h.v=(n=h.v,(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5)):h.t="s",a[c]=h}}return o.s.c<1e7&&(a["!ref"]=t.utils.encode_range(o)),a}(l);if(h.length>0&&(g["!merges"]||(g["!merges"]=[]),h.forEach((e=>{g["!merges"].push(t.utils.decode_range(e))}))),c){const e=l.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}))));let t=e[0];for(let r=1;r<e.length;r++)for(let n=0;n<e[r].length;n++)t[n].wch<e[r][n].wch&&(t[n].wch=e[r][n].wch);g["!cols"]=t}u.SheetNames.push(f),u.Sheets.SheetJS=g;var p=t.write(u,{bookType:i,bookSST:!1,type:"binary"});e(new Blob([n(p)],{type:"application/octet-stream"}),`${s}.${i}`)}function o(e){let{header:t,data:r,filename:n,autoWidth:o=!0,type:l="xlsx"}={param:e};a.export_json_to_excel(t,r,n,o,l)}export{o as default};
